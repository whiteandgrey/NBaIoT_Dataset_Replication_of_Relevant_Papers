# N-BaIoT 自编码器训练系统 - GUI版使用说明

## 1. 系统简介

N-BaIoT自编码器训练系统GUI版是一个窗口化的图形用户界面应用程序，专门用于训练基于深度自编码器的物联网设备异常检测模型。该系统提供了完整的配置管理、训练控制、实时监控和可视化功能。

### 1.1 主要功能

- **可视化配置界面**：通过直观的图形界面配置所有训练参数
- **训练控制**：支持开始、暂停、停止训练操作
- **实时进度显示**：显示当前训练进度、Epoch信息、损失值等
- **动态折线图**：实时更新训练损失曲线，支持可视化监控
- **详细日志输出**：记录完整的训练过程日志
- **多设备支持**：支持同时训练多个IoT设备
- **GPU控制**：完善的GPU资源配置和控制选项

### 1.2 技术栈

- **深度学习框架**：TensorFlow 2.10+ / Keras
- **图形界面**：PyQt5
- **数据处理**：NumPy, pandas, scikit-learn
- **可视化**：Matplotlib

## 2. 安装指南

### 2.1 环境要求

- **操作系统**：Windows 10/11, macOS, Linux
- **Python版本**：3.8 - 3.11（推荐3.9或3.10）
- **内存**：至少4GB RAM（推荐8GB+）
- **存储**：至少2GB可用空间
- **GPU**（可选）：NVIDIA GPU + CUDA驱动

### 2.2 安装步骤

#### 步骤1：安装Python

确保系统已安装Python 3.8或更高版本。可从[Python官网](https://www.python.org/downloads/)下载安装。

#### 步骤2：安装依赖包

打开终端或命令提示符，运行以下命令：

```bash
# 方法1：使用pip安装所有依赖
pip install -r requirements_gui.txt

# 方法2：逐个安装
pip install tensorflow
pip install PyQt5
pip install numpy pandas scikit-learn matplotlib seaborn scipy joblib
```

#### 步骤3：验证安装

```bash
# 验证Python环境
python --version

# 验证TensorFlow
python -c "import tensorflow as tf; print('TensorFlow:', tf.__version__)"

# 验证PyQt5
python -c "from PyQt5.QtWidgets import QApplication; print('PyQt5: OK')"

# 验证Matplotlib
python -c "import matplotlib; print('Matplotlib:', matplotlib.__version__)"
```

### 2.3 常见安装问题

#### 问题1：PyQt5安装失败

```bash
# Windows
pip install --user PyQt5

# macOS
brew install pyqt5

# Linux (Ubuntu/Debian)
sudo apt-get install python3-pyqt5
```

#### 问题2：TensorFlow安装问题

```bash
# 使用国内镜像源
pip install tensorflow -i https://pypi.tuna.tsinghua.edu.cn/simple/

# 或安装特定版本
pip install tensorflow==2.12.0
```

#### 问题3：GPU支持

```bash
# 安装CUDA版本的TensorFlow
pip install tensorflow-gpu

# 或使用pip安装CUDA工具包
# 请参考NVIDIA官方文档安装CUDA和cuDNN
```

## 3. 使用说明

### 3.1 启动程序

在项目目录下运行：

```bash
python gui_app.py
```

或双击（如果已配置文件关联）`gui_app.py`文件。

### 3.2 主界面介绍

主界面由以下几个主要区域组成：

```
┌─────────────────────────────────────────────────────────────────────┐
│  菜单栏: 文件 | 工具 | 帮助                                          │
├─────────────────────────────────────────────────────────────────────┤
│  ┌──────────────────────┐  ┌─────────────────────────────────────┐  │
│  │  配置面板 (左侧)      │  │  实时图表区域 (右侧)                │  │
│  │  ├─ 基础配置         │  │  ├─ 训练损失曲线图                   │  │
│  │  ├─ 模型架构         │  │  └─ 训练进度信息                     │  │
│  │  ├─ 训练参数         │  │                                     │  │
│  │  ├─ 设备选择         │  │                                     │  │
│  │  └─ 高级选项         │  │                                     │  │
│  └──────────────────────┘  └─────────────────────────────────────┘  │
├─────────────────────────────────────────────────────────────────────┤
│  ┌──────────────────────┐  ┌─────────────────────────────────────┐  │
│  │  训练日志 (左下)      │  │  控制面板 (右下)                     │  │
│  │                      │  │  ├─ 开始/暂停/停止按钮               │  │
│  │                      │  │  ├─ 进度条                           │  │
│  │                      │  │  └─ 状态显示                         │  │
│  └──────────────────────┘  └─────────────────────────────────────┘  │
├─────────────────────────────────────────────────────────────────────┤
│  状态栏: 显示当前状态和进度                                        │
└─────────────────────────────────────────────────────────────────────┘
```

### 3.3 配置参数

#### 3.3.1 基础配置

| 参数 | 说明 | 默认值 |
|------|------|--------|
| 数据根目录 | N-BaIoT数据集的根路径 | config.py中设置 |
| 输出目录 | 训练结果保存目录 | ./training_results |
| 启用GPU | 是否使用GPU加速 | False |
| GPU内存限制 | GPU内存限制(MB)，0表示无限制 | 0 |
| 特征维度 | 输入数据特征维度 | 115 |

#### 3.3.2 模型架构

| 参数 | 说明 | 默认值 |
|------|------|--------|
| 激活函数 | 隐藏层激活函数 | relu |
| 批量归一化 | 是否使用BatchNorm | False |
| Dropout率 | Dropout比例 | 0.0 |
| L2正则化 | L2正则化系数 | 0.001 |
| 编码器维度比例 | 编码器各层压缩比例 | [0.75, 0.50, 0.33, 0.25] |
| 解码器维度比例 | 解码器各层恢复比例 | [0.33, 0.50, 0.75, 1.0] |

#### 3.3.3 训练参数

| 参数 | 说明 | 默认值 |
|------|------|--------|
| 默认学习率 | 初始学习率 | 0.001 |
| 默认批大小 | 批次样本数 | 64 |
| 默认训练轮数 | 训练Epoch数 | 100 |
| 早停耐心值 | 早停判定Epoch数 | 15 |
| LR调整因子 | 学习率衰减因子 | 0.5 |
| 随机种子 | 随机数种子 | 42 |

#### 3.3.4 设备选择

系统支持以下9种IoT设备：

1. Danmini_Doorbell - 门铃设备
2. Ecobee_Thermostat - 恒温器
3. Ennio_Doorbell - 门铃设备
4. Philips_B120N10_Baby_Monitor - 婴儿监视器
5. Provision_PT_737E_Security_Camera - 安全摄像头
6. Provision_PT_838_Security_Camera - 安全摄像头
7. Samsung_SNH_1011_N_Webcam - 网络摄像头
8. SimpleHome_XCS7_1002_WHT_Security_Camera - 安全摄像头
9. SimpleHome_XCS7_1003_WHT_Security_Camera - 安全摄像头

### 3.4 开始训练

1. **配置参数**：在左侧配置面板中设置各项参数
2. **选择设备**：在"设备选择"选项卡中勾选要训练的设备
3. **开始训练**：点击右下角的"开始训练"按钮
4. **监控进度**：
   - 观察右侧的实时损失曲线图
   - 查看下方的训练日志
   - 关注状态栏的进度信息
5. **控制训练**：
   - 点击"暂停"可暂停训练
   - 点击"停止"可终止训练

### 3.5 查看结果

训练完成后，结果会自动保存到配置的输出目录，结构如下：

```
output_dir/
├── training_results/
│   ├── training_plots/
│   │   └── *.png (训练曲线图)
│   ├── comparison_plots/
│   │   └── *.png (比较图)
│   ├── device_name/
│   │   ├── final_model.h5 (最终模型)
│   │   ├── best_model.h5 (最佳模型)
│   │   ├── scaler.pkl (数据标准化器)
│   │   └── training_history.json (训练历史)
│   └── training_results_summary.csv (结果汇总)
```

## 4. 高级功能

### 4.1 配置保存与加载

系统支持将配置保存到文件，便于复现实验：

1. **保存配置**：菜单栏 → 文件 → 保存配置
2. **加载配置**：菜单栏 → 文件 → 加载配置
3. 配置以JSON格式保存

### 4.2 GPU配置

#### 使用GPU

1. 在"基础配置"中勾选"启用GPU加速"
2. 设置GPU内存限制（可选）

#### 使用多个GPU

通过修改代码中的`GPU_DEVICES`参数来指定使用的GPU。

#### CPU模式

如需强制使用CPU，禁用GPU选项即可。

### 4.3 超参数调优

系统内置三阶段训练流程：

1. **初始训练**：使用默认参数建立基准
2. **超参数优化**：网格搜索最优学习率和Epoch组合
3. **最终训练**：使用最优参数训练最终模型

### 4.4 实时图表说明

右侧的实时折线图显示：

- **蓝色线**：训练损失(Training Loss)
- **红色线**：验证损失(Validation Loss)
- **X轴**：Epoch编号
- **Y轴**：MSE损失值

图表会自动更新显示当前训练状态。

## 5. 常见问题

### Q1: 程序无法启动？

**解决方案**：
- 检查Python版本是否为3.8+
- 确认已安装所有依赖包
- 查看控制台错误信息

### Q2: GPU不可用？

**解决方案**：
- 确认已安装NVIDIA驱动
- 检查CUDA和cuDNN是否正确安装
- 尝试使用`nvidia-smi`命令验证GPU状态

### Q3: 训练速度慢？

**解决方案**：
- 启用GPU加速
- 减小批大小
- 减少训练设备数量
- 限制超参数搜索空间

### Q4: 内存不足？

**解决方案**：
- 减小批大小
- 启用GPU内存增长限制
- 减少单次训练的设备数量

### Q5: 如何查看训练历史？

**解决方案**：
- 训练日志会实时显示在左下角
- 完整的训练历史保存在`training_history.json`文件中
- 可使用TensorBoard查看详细日志（如果已启用）

## 6. 命令行对比

本GUI版本与原命令行版本功能完全一致，只是操作方式不同：

| 功能 | 命令行版本 | GUI版本 |
|------|-----------|---------|
| 配置参数 | 修改config.py | 图形界面设置 |
| 开始训练 | python main.py | 点击"开始训练" |
| 暂停训练 | Ctrl+C | 点击"暂停" |
| 查看日志 | 控制台输出 | 左侧日志面板 |
| 实时图表 | 需额外配置 | 自动显示 |

## 7. 注意事项

1. **数据准备**：确保N-BaIoT数据集已正确下载并配置路径
2. **首次运行**：首次运行会自动创建必要的目录结构
3. **训练时间**：完整训练可能需要较长时间，请耐心等待
4. **资源占用**：训练过程中会占用较多CPU/GPU资源
5. **结果保存**：训练结果会自动保存，建议定期备份

## 8. 技术支持

如遇到问题，请：

1. 查看控制台错误信息
2. 检查训练日志
3. 验证数据路径和依赖安装
4. 参考原版技术文档

## 9. 版本信息

- **版本**：2.0 GUI版
- **作者**：MiniMax Agent
- **许可证**：教育研究用途
- **最后更新**：2026-01-30

---

**提示**：如需使用命令行版本，可继续使用原有的`main.py`程序。GUI版本提供了更友好的操作体验，但功能完全一致。
